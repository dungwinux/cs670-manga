Removing conda
Loading conda
Using CUDA
Cleared output folder
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ARMS
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AisazuNihaIrarenai
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AkkeraKanjinchou
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Akuhamu
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AosugiruHaru
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AppareKappore
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Arisa
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BEMADER_P
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BakuretsuKungFuGirl
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Belmondo
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BokuHaSitatakaKun
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BurariTessenTorimonocho
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ByebyeC-BOY
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Count3DeKimeteAgeru
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/DollGun
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Donburakokko
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/DualJustice
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EienNoWith
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EvaLady
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EverydayOsakanaChan
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GOOD_KISS_Ver2
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GakuenNoise
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GarakutayaManta
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GinNoChimera
Images in this folder will be overwritten if they have the same name
Done creating line images
./checkpoints/mangainpaintor/config.yml
Model configurations:
---------------------------------
MODE: 3             # 1: train, 2: test, 3: eval
MODEL: 4            # 1: edge model, 2: inpaint model, 3: edge-inpaint model, 4: manga inpaint model, 5: joint model
MASK: 3             # 1: random block, 2: half, 3: external, 4: (external, random block), 5: (external, random block, half)
EDGE: 2             # 1: canny, 2: external
NMS: 0              # 0: no non-max-suppression, 1: applies non-max-suppression on the external edges by multiplying by Canny
SEED: 2021            # random seed
GPU: [0]            # list of gpu ids
DEBUG: 0            # turns on debugging mode
VERBOSE: 0          # turns on verbose mode in the output console
NCOLORS: 1  

TRAIN_FLIST: ./datasets/manga_train.flist
VAL_FLIST: ./datasets/manga_val.flist
TEST_FLIST: ./datasets/manga_test.flist

TRAIN_LINE_FLIST: ./datasets/manga_lines_train.flist
VAL_LINE_FLIST: ./datasets/manga_lines_val.flist
TEST_LINE_FLIST: ./datasets/manga_lines_test.flist

TRAIN_MASK_FLIST: ./datasets/masks_train.flist
VAL_MASK_FLIST: ./datasets/masks_val.flist
TEST_MASK_FLIST: ./datasets/masks_test.flist

LR: 0.0001                    # learning rate
D2G_LR: 0.2                   # discriminator/generator learning rate ratio
BETA1: 0.9                    # adam optimizer beta1
BETA2: 0.999                    # adam optimizer beta2
BATCH_SIZE: 4                 # input batch size for training
INPUT_SIZE: 512               # input image size for training 0 for original size
SIGMA: 2                      # standard deviation of the Gaussian filter used in Canny edge detector (0: random, -1: no edge)
MAX_ITERS: 2e6                # maximum number of iterations to train the model

SHRIK_ITERS: 5
EDGE_THRESHOLD: 0.5           # edge detection threshold
WEIGHTED_L1_LOSS_WEIGHT: 20   # structural line reconstruction weight
L1_LOSS_WEIGHT: 20            # ScreenVAE map loss weight
CONTENT_LOSS_WEIGHT: 200      # screentone reconstruction weight
BINARY_LOSS_WEIGHT: 1         # binarization loss weight
EDGE_LOSS_WEIGHT: 0           # edge loss weight
INPAINT_ADV_LOSS_WEIGHT: 1    # adversarial loss weight
FM_LOSS_WEIGHT: 5             # feature-matching loss weight

GAN_LOSS: nsgan               # nsgan | lsgan | hinge
GAN_POOL_SIZE: 0              # fake images pool size

SAVE_INTERVAL: 1000           # how many iterations to wait before saving model (0: never)
SAMPLE_INTERVAL: 1000         # how many iterations to wait before sampling (0: never)
SAMPLE_SIZE: 6               # number of images to sample
EVAL_INTERVAL: 0              # how many iterations to wait before model evaluation (0: never)
LOG_INTERVAL: 10              # how many iterations to wait before logging training status (0: never)


---------------------------------

initialize network with normal
initialize network with xavier
loading the model from checkpoints/ScreenVAE/latest_net_enc.pth
loading the model from checkpoints/ScreenVAE/latest_net_dec.pth
Loading models...
Loading SemanticInpaintingModel generator...
Loading MangaInpaintingModel generator...

start testing...

0 000.jpg
1 001.jpg
2 002.jpg
3 003.jpg
4 004.jpg
5 005.jpg
6 006.jpg
7 007.jpg
8 008.jpg
9 009.jpg
10 000.jpg
11 001.jpg
12 002.jpg
13 003.jpg
14 004.jpg
15 005.jpg
16 006.jpg
17 007.jpg
18 008.jpg
19 009.jpg
20 000.jpg
21 001.jpg
22 002.jpg
23 003.jpg
24 004.jpg
25 005.jpg
26 006.jpg
27 007.jpg
28 008.jpg
29 009.jpg
30 000.jpg
31 001.jpg
32 002.jpg
33 003.jpg
34 004.jpg
35 005.jpg
36 006.jpg
37 007.jpg
38 008.jpg
39 009.jpg
40 000.jpg
41 001.jpg
42 002.jpg
43 003.jpg
44 004.jpg
45 005.jpg
46 006.jpg
47 007.jpg
48 008.jpg
49 009.jpg
50 000.jpg
51 001.jpg
52 002.jpg
53 003.jpg
54 004.jpg
55 005.jpg
56 006.jpg
57 007.jpg
58 008.jpg
59 009.jpg
60 000.jpg
61 001.jpg
62 002.jpg
63 003.jpg
64 004.jpg
65 005.jpg
66 006.jpg
67 007.jpg
68 008.jpg
69 009.jpg
70 000.jpg
71 001.jpg
72 002.jpg
73 003.jpg
74 004.jpg
75 005.jpg
76 006.jpg
77 007.jpg
78 008.jpg
79 009.jpg
80 000.jpg
81 001.jpg
82 002.jpg
83 003.jpg
84 004.jpg
85 005.jpg
86 006.jpg
87 007.jpg
88 008.jpg
89 009.jpg
90 000.jpg
91 001.jpg
92 002.jpg
93 003.jpg
94 004.jpg
95 005.jpg
96 006.jpg
97 007.jpg
98 008.jpg
99 009.jpg
100 000.jpg
101 001.jpg
102 002.jpg
103 003.jpg
104 004.jpg
105 005.jpg
106 006.jpg
107 007.jpg
108 008.jpg
109 009.jpg
110 000.jpg
111 001.jpg
112 002.jpg
113 003.jpg
114 004.jpg
115 005.jpg
116 006.jpg
117 007.jpg
118 008.jpg
119 009.jpg
120 000.jpg
121 001.jpg
122 002.jpg
123 003.jpg
124 004.jpg
125 005.jpg
126 006.jpg
127 007.jpg
128 008.jpg
129 009.jpg
130 000.jpg
131 001.jpg
132 002.jpg
133 003.jpg
134 004.jpg
135 005.jpg
136 006.jpg
137 007.jpg
138 008.jpg
139 009.jpg
140 000.jpg
141 001.jpg
142 002.jpg
143 003.jpg
144 004.jpg
145 005.jpg
146 006.jpg
147 007.jpg
148 008.jpg
149 009.jpg
150 000.jpg
151 001.jpg
152 002.jpg
153 003.jpg
154 004.jpg
155 005.jpg
156 006.jpg
157 007.jpg
158 008.jpg
159 009.jpg
160 000.jpg
161 001.jpg
162 002.jpg
163 003.jpg
164 004.jpg
165 005.jpg
166 006.jpg
167 007.jpg
168 008.jpg
169 009.jpg
170 000.jpg
171 001.jpg
172 002.jpg
173 003.jpg
174 004.jpg
175 005.jpg
176 006.jpg
177 007.jpg
178 008.jpg
179 009.jpg
180 000.jpg
181 001.jpg
182 002.jpg
183 003.jpg
184 004.jpg
185 005.jpg
186 006.jpg
187 007.jpg
188 008.jpg
189 009.jpg
190 000.jpg
191 001.jpg
192 002.jpg
193 003.jpg
194 004.jpg
195 005.jpg
196 006.jpg
197 007.jpg
198 008.jpg
199 009.jpg
200 000.jpg
201 001.jpg
202 002.jpg
203 003.jpg
204 004.jpg
205 005.jpg
206 006.jpg
207 007.jpg
208 008.jpg
209 009.jpg
210 000.jpg
211 001.jpg
212 002.jpg
213 003.jpg
214 004.jpg
215 005.jpg
216 006.jpg
217 007.jpg
218 008.jpg
219 009.jpg
220 000.jpg
221 001.jpg
222 002.jpg
223 003.jpg
224 004.jpg
225 005.jpg
226 006.jpg
227 007.jpg
228 008.jpg
229 009.jpg
230 000.jpg
231 001.jpg
232 002.jpg
233 003.jpg
234 004.jpg
235 005.jpg
236 006.jpg
237 007.jpg
238 008.jpg
239 009.jpg

End test....
