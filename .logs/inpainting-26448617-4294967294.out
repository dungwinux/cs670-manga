Removing conda
Loading conda
Using CUDA
Cleared output folder
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ARMS
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AisazuNihaIrarenai
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AkkeraKanjinchou
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Akuhamu
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AosugiruHaru
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AppareKappore
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Arisa
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BEMADER_P
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BakuretsuKungFuGirl
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Belmondo
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BokuHaSitatakaKun
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BurariTessenTorimonocho
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ByebyeC-BOY
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Count3DeKimeteAgeru
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/DollGun
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Donburakokko
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/DualJustice
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EienNoWith
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EvaLady
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EverydayOsakanaChan
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GOOD_KISS_Ver2
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GakuenNoise
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GarakutayaManta
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GinNoChimera
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Hamlet
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HanzaiKousyouninMinegishiEitarou
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HaruichibanNoFukukoro
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HarukaRefrain
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HealingPlanet
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HeiseiJimen
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HighschoolKimengumi_vol01
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HighschoolKimengumi_vol20
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HinagikuKenzan
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/HisokaReturns
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/JangiriPonpon
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/JijiBabaFight
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Joouari
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Jyovolley
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/KarappoHighschool
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/KimiHaBokuNoTaiyouDa
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/KoukouNoHitotachi
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/KuroidoGanka
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/KyokugenCyclone
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/LancelotFullThrottle
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/LoveHina_vol01
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/LoveHina_vol14
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MAD_STONE
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MadouTaiga
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MagicStarGakuin
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MagicianLoad
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MariaSamaNihaNaisyo
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MayaNoAkaiKutsu
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MemorySeijin
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MeteoSanStrikeDesu
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MiraiSan
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MisutenaideDaisy
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MoeruOnisan_vol01
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MoeruOnisan_vol19
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MomoyamaHaikagura
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MukoukizuNoChonbo
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/MutekiBoukenSyakuma
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Nekodama
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/NichijouSoup
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Ningyoushi
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/OL_Lunch
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/OhWareraRettouSeitokai
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/PLANET7
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ParaisoRoad
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/PikaruGenkiDesu
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/PlatinumJungle
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/PrayerHaNemurenai
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/PrismHeart
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/PsychoStaff
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Raphael
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ReveryEarth
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/RinToSiteSippuNoNaka
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/RisingGirl
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Saisoku
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/SaladDays_vol01
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/SaladDays_vol18
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/SamayoeruSyonenNiJunaiWo
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/SeisinkiVulnus
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ShimatteIkouze_vol01
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ShimatteIkouze_vol26
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/SonokiDeABC
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/SyabondamaKieta
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TaiyouNiSmash
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TapkunNoTanteisitsu
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TasogareTsushin
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TennenSenshiG
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TensiNoHaneToAkumaNoShippo
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TetsuSan
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/That'sIzumiko
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TotteokiNoABC
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ToutaMairimasu
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TouyouKidan
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/TsubasaNoKioku
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/UchiNoNyan'sDiary
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/UchuKigekiM774
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/UltraEleven
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/UnbalanceTokyo
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/WarewareHaOniDearu
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/YamatoNoHane
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/YasasiiAkuma
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/YouchienBoueigumi
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/YoumaKourin
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/YukiNoFuruMachi
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/YumeNoKayoiji
Images in this folder will be overwritten if they have the same name
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/YumeiroCooking
Images in this folder will be overwritten if they have the same name
  0%|          | 0/10602 [00:00<?, ?it/s]  0%|          | 0/10602 [00:00<?, ?it/s]
Done creating line images
./checkpoints/mangainpaintor/config.yml
Model configurations:
---------------------------------
MODE: 3             # 1: train, 2: test, 3: eval
MODEL: 4            # 1: edge model, 2: inpaint model, 3: edge-inpaint model, 4: manga inpaint model, 5: joint model
MASK: 3             # 1: random block, 2: half, 3: external, 4: (external, random block), 5: (external, random block, half)
EDGE: 2             # 1: canny, 2: external
NMS: 0              # 0: no non-max-suppression, 1: applies non-max-suppression on the external edges by multiplying by Canny
SEED: 2021            # random seed
GPU: [0]            # list of gpu ids
DEBUG: 0            # turns on debugging mode
VERBOSE: 0          # turns on verbose mode in the output console
NCOLORS: 1  

TRAIN_FLIST: ./datasets/manga_train.flist
VAL_FLIST: ./datasets/manga_val.flist
TEST_FLIST: ./datasets/manga_test.flist

TRAIN_LINE_FLIST: ./datasets/manga_lines_train.flist
VAL_LINE_FLIST: ./datasets/manga_lines_val.flist
TEST_LINE_FLIST: ./datasets/manga_lines_test.flist

TRAIN_MASK_FLIST: ./datasets/masks_train.flist
VAL_MASK_FLIST: ./datasets/masks_val.flist
TEST_MASK_FLIST: ./datasets/masks_test.flist

LR: 0.0001                    # learning rate
D2G_LR: 0.2                   # discriminator/generator learning rate ratio
BETA1: 0.9                    # adam optimizer beta1
BETA2: 0.999                    # adam optimizer beta2
BATCH_SIZE: 4                 # input batch size for training
INPUT_SIZE: 512               # input image size for training 0 for original size
SIGMA: 2                      # standard deviation of the Gaussian filter used in Canny edge detector (0: random, -1: no edge)
MAX_ITERS: 2e6                # maximum number of iterations to train the model

SHRIK_ITERS: 5
EDGE_THRESHOLD: 0.5           # edge detection threshold
WEIGHTED_L1_LOSS_WEIGHT: 20   # structural line reconstruction weight
L1_LOSS_WEIGHT: 20            # ScreenVAE map loss weight
CONTENT_LOSS_WEIGHT: 200      # screentone reconstruction weight
BINARY_LOSS_WEIGHT: 1         # binarization loss weight
EDGE_LOSS_WEIGHT: 0           # edge loss weight
INPAINT_ADV_LOSS_WEIGHT: 1    # adversarial loss weight
FM_LOSS_WEIGHT: 5             # feature-matching loss weight

GAN_LOSS: nsgan               # nsgan | lsgan | hinge
GAN_POOL_SIZE: 0              # fake images pool size

SAVE_INTERVAL: 1000           # how many iterations to wait before saving model (0: never)
SAMPLE_INTERVAL: 1000         # how many iterations to wait before sampling (0: never)
SAMPLE_SIZE: 6               # number of images to sample
EVAL_INTERVAL: 0              # how many iterations to wait before model evaluation (0: never)
LOG_INTERVAL: 10              # how many iterations to wait before logging training status (0: never)


---------------------------------

initialize network with normal
initialize network with xavier
loading the model from checkpoints/ScreenVAE/latest_net_enc.pth
loading the model from checkpoints/ScreenVAE/latest_net_dec.pth
Loading models...
Loading SemanticInpaintingModel generator...
Loading MangaInpaintingModel generator...

start testing...

loading error: /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/inputs/ARMS/000.jpg
Traceback (most recent call last):
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/src/dataset.py", line 94, in __getitem__
    item = self.load_item(index)
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/src/dataset.py", line 122, in load_item
    mask = self.load_mask(size, index)
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/src/dataset.py", line 183, in load_mask
    mask = rgb2gray(mask)
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/skimage/_shared/utils.py", line 438, in fixed_func
    return func(*args, **kwargs)
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/skimage/color/colorconv.py", line 982, in rgb2gray
    rgb = _prepare_colorarray(rgb)
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/skimage/color/colorconv.py", line 170, in _prepare_colorarray
    raise ValueError(msg)
ValueError: the input array must have size 3 along `channel_axis`, got (1176, 1656)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/model_torch.py", line 348, in <module>
    inpaint(None, line_model_info)
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/test.py", line 105, in inpaint
    model.test()
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/src/manga_inpaintor.py", line 45, in test
    for items in test_loader:
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/src/dataset.py", line 97, in __getitem__
    item = self.load_item(0)
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/src/dataset.py", line 122, in load_item
    mask = self.load_mask(size, index)
  File "/work/pi_miyyer_umass_edu/ctpham/cs670-manga/src/dataset.py", line 183, in load_mask
    mask = rgb2gray(mask)
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/skimage/_shared/utils.py", line 438, in fixed_func
    return func(*args, **kwargs)
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/skimage/color/colorconv.py", line 982, in rgb2gray
    rgb = _prepare_colorarray(rgb)
  File "/scratch/workspace/ctpham_umass_edu-llama/envs/manga/lib/python3.10/site-packages/skimage/color/colorconv.py", line 170, in _prepare_colorarray
    raise ValueError(msg)
ValueError: the input array must have size 3 along `channel_axis`, got (1176, 1656)
