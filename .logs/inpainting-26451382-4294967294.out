Removing conda
Loading conda
Using CUDA
Cleared output folder
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ARMS
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/ARMS
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AisazuNihaIrarenai
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/AisazuNihaIrarenai
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AkkeraKanjinchou
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/AkkeraKanjinchou
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Akuhamu
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/Akuhamu
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AosugiruHaru
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/AosugiruHaru
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/AppareKappore
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/AppareKappore
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Arisa
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/Arisa
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BEMADER_P
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/BEMADER_P
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BakuretsuKungFuGirl
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/BakuretsuKungFuGirl
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Belmondo
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/Belmondo
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BokuHaSitatakaKun
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/BokuHaSitatakaKun
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/BurariTessenTorimonocho
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/BurariTessenTorimonocho
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/ByebyeC-BOY
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/ByebyeC-BOY
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Count3DeKimeteAgeru
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/Count3DeKimeteAgeru
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/DollGun
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/DollGun
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/Donburakokko
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/Donburakokko
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/DualJustice
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/DualJustice
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EienNoWith
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/EienNoWith
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EvaLady
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/EvaLady
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/EverydayOsakanaChan
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/EverydayOsakanaChan
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GOOD_KISS_Ver2
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/GOOD_KISS_Ver2
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GakuenNoise
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/GakuenNoise
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GarakutayaManta
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/GarakutayaManta
WARNING: Folder already exists:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/lines/GinNoChimera
Images in this folder will be overwritten if they have the same name
Created folder:  /scratch2/workspace/ctpham_umass_edu-hp/cs670-manga/outputs/GinNoChimera
Done creating line images
./checkpoints/mangainpaintor/config.yml
Model configurations:
---------------------------------
MODE: 3             # 1: train, 2: test, 3: eval
MODEL: 4            # 1: edge model, 2: inpaint model, 3: edge-inpaint model, 4: manga inpaint model, 5: joint model
MASK: 3             # 1: random block, 2: half, 3: external, 4: (external, random block), 5: (external, random block, half)
EDGE: 2             # 1: canny, 2: external
NMS: 0              # 0: no non-max-suppression, 1: applies non-max-suppression on the external edges by multiplying by Canny
SEED: 2021            # random seed
GPU: [0]            # list of gpu ids
DEBUG: 0            # turns on debugging mode
VERBOSE: 0          # turns on verbose mode in the output console
NCOLORS: 1  

TRAIN_FLIST: ./datasets/manga_train.flist
VAL_FLIST: ./datasets/manga_val.flist
TEST_FLIST: ./datasets/manga_test.flist

TRAIN_LINE_FLIST: ./datasets/manga_lines_train.flist
VAL_LINE_FLIST: ./datasets/manga_lines_val.flist
TEST_LINE_FLIST: ./datasets/manga_lines_test.flist

TRAIN_MASK_FLIST: ./datasets/masks_train.flist
VAL_MASK_FLIST: ./datasets/masks_val.flist
TEST_MASK_FLIST: ./datasets/masks_test.flist

LR: 0.0001                    # learning rate
D2G_LR: 0.2                   # discriminator/generator learning rate ratio
BETA1: 0.9                    # adam optimizer beta1
BETA2: 0.999                    # adam optimizer beta2
BATCH_SIZE: 4                 # input batch size for training
INPUT_SIZE: 512               # input image size for training 0 for original size
SIGMA: 2                      # standard deviation of the Gaussian filter used in Canny edge detector (0: random, -1: no edge)
MAX_ITERS: 2e6                # maximum number of iterations to train the model

SHRIK_ITERS: 5
EDGE_THRESHOLD: 0.5           # edge detection threshold
WEIGHTED_L1_LOSS_WEIGHT: 20   # structural line reconstruction weight
L1_LOSS_WEIGHT: 20            # ScreenVAE map loss weight
CONTENT_LOSS_WEIGHT: 200      # screentone reconstruction weight
BINARY_LOSS_WEIGHT: 1         # binarization loss weight
EDGE_LOSS_WEIGHT: 0           # edge loss weight
INPAINT_ADV_LOSS_WEIGHT: 1    # adversarial loss weight
FM_LOSS_WEIGHT: 5             # feature-matching loss weight

GAN_LOSS: nsgan               # nsgan | lsgan | hinge
GAN_POOL_SIZE: 0              # fake images pool size

SAVE_INTERVAL: 1000           # how many iterations to wait before saving model (0: never)
SAMPLE_INTERVAL: 1000         # how many iterations to wait before sampling (0: never)
SAMPLE_SIZE: 6               # number of images to sample
EVAL_INTERVAL: 0              # how many iterations to wait before model evaluation (0: never)
LOG_INTERVAL: 10              # how many iterations to wait before logging training status (0: never)


---------------------------------

initialize network with normal
initialize network with xavier
loading the model from checkpoints/ScreenVAE/latest_net_enc.pth
loading the model from checkpoints/ScreenVAE/latest_net_dec.pth
Loading models...
Loading SemanticInpaintingModel generator...
Loading MangaInpaintingModel generator...

start testing...

0 ARMS/000.jpg
1 ARMS/001.jpg
2 ARMS/002.jpg
3 ARMS/003.jpg
4 ARMS/004.jpg
5 ARMS/005.jpg
6 ARMS/006.jpg
7 ARMS/007.jpg
8 ARMS/008.jpg
9 ARMS/009.jpg
10 AisazuNihaIrarenai/000.jpg
11 AisazuNihaIrarenai/001.jpg
12 AisazuNihaIrarenai/002.jpg
13 AisazuNihaIrarenai/003.jpg
14 AisazuNihaIrarenai/004.jpg
15 AisazuNihaIrarenai/005.jpg
16 AisazuNihaIrarenai/006.jpg
17 AisazuNihaIrarenai/007.jpg
18 AisazuNihaIrarenai/008.jpg
19 AisazuNihaIrarenai/009.jpg
20 AkkeraKanjinchou/000.jpg
21 AkkeraKanjinchou/001.jpg
22 AkkeraKanjinchou/002.jpg
23 AkkeraKanjinchou/003.jpg
24 AkkeraKanjinchou/004.jpg
25 AkkeraKanjinchou/005.jpg
26 AkkeraKanjinchou/006.jpg
27 AkkeraKanjinchou/007.jpg
28 AkkeraKanjinchou/008.jpg
29 AkkeraKanjinchou/009.jpg
30 Akuhamu/000.jpg
31 Akuhamu/001.jpg
32 Akuhamu/002.jpg
33 Akuhamu/003.jpg
34 Akuhamu/004.jpg
35 Akuhamu/005.jpg
36 Akuhamu/006.jpg
37 Akuhamu/007.jpg
38 Akuhamu/008.jpg
39 Akuhamu/009.jpg
40 AosugiruHaru/000.jpg
41 AosugiruHaru/001.jpg
42 AosugiruHaru/002.jpg
43 AosugiruHaru/003.jpg
44 AosugiruHaru/004.jpg
45 AosugiruHaru/005.jpg
46 AosugiruHaru/006.jpg
47 AosugiruHaru/007.jpg
48 AosugiruHaru/008.jpg
49 AosugiruHaru/009.jpg
50 AppareKappore/000.jpg
51 AppareKappore/001.jpg
52 AppareKappore/002.jpg
53 AppareKappore/003.jpg
54 AppareKappore/004.jpg
55 AppareKappore/005.jpg
56 AppareKappore/006.jpg
57 AppareKappore/007.jpg
58 AppareKappore/008.jpg
59 AppareKappore/009.jpg
60 Arisa/000.jpg
61 Arisa/001.jpg
62 Arisa/002.jpg
63 Arisa/003.jpg
64 Arisa/004.jpg
65 Arisa/005.jpg
66 Arisa/006.jpg
67 Arisa/007.jpg
68 Arisa/008.jpg
69 Arisa/009.jpg
70 BEMADER_P/000.jpg
71 BEMADER_P/001.jpg
72 BEMADER_P/002.jpg
73 BEMADER_P/003.jpg
74 BEMADER_P/004.jpg
75 BEMADER_P/005.jpg
76 BEMADER_P/006.jpg
77 BEMADER_P/007.jpg
78 BEMADER_P/008.jpg
79 BEMADER_P/009.jpg
80 BakuretsuKungFuGirl/000.jpg
81 BakuretsuKungFuGirl/001.jpg
82 BakuretsuKungFuGirl/002.jpg
83 BakuretsuKungFuGirl/003.jpg
84 BakuretsuKungFuGirl/004.jpg
85 BakuretsuKungFuGirl/005.jpg
86 BakuretsuKungFuGirl/006.jpg
87 BakuretsuKungFuGirl/007.jpg
88 BakuretsuKungFuGirl/008.jpg
89 BakuretsuKungFuGirl/009.jpg
90 Belmondo/000.jpg
91 Belmondo/001.jpg
92 Belmondo/002.jpg
93 Belmondo/003.jpg
94 Belmondo/004.jpg
95 Belmondo/005.jpg
96 Belmondo/006.jpg
97 Belmondo/007.jpg
98 Belmondo/008.jpg
99 Belmondo/009.jpg
100 BokuHaSitatakaKun/000.jpg
101 BokuHaSitatakaKun/001.jpg
102 BokuHaSitatakaKun/002.jpg
103 BokuHaSitatakaKun/003.jpg
104 BokuHaSitatakaKun/004.jpg
105 BokuHaSitatakaKun/005.jpg
106 BokuHaSitatakaKun/006.jpg
107 BokuHaSitatakaKun/007.jpg
108 BokuHaSitatakaKun/008.jpg
109 BokuHaSitatakaKun/009.jpg
110 BurariTessenTorimonocho/000.jpg
111 BurariTessenTorimonocho/001.jpg
112 BurariTessenTorimonocho/002.jpg
113 BurariTessenTorimonocho/003.jpg
114 BurariTessenTorimonocho/004.jpg
115 BurariTessenTorimonocho/005.jpg
116 BurariTessenTorimonocho/006.jpg
117 BurariTessenTorimonocho/007.jpg
118 BurariTessenTorimonocho/008.jpg
119 BurariTessenTorimonocho/009.jpg
120 ByebyeC-BOY/000.jpg
121 ByebyeC-BOY/001.jpg
122 ByebyeC-BOY/002.jpg
123 ByebyeC-BOY/003.jpg
124 ByebyeC-BOY/004.jpg
125 ByebyeC-BOY/005.jpg
126 ByebyeC-BOY/006.jpg
127 ByebyeC-BOY/007.jpg
128 ByebyeC-BOY/008.jpg
129 ByebyeC-BOY/009.jpg
130 Count3DeKimeteAgeru/000.jpg
131 Count3DeKimeteAgeru/001.jpg
132 Count3DeKimeteAgeru/002.jpg
133 Count3DeKimeteAgeru/003.jpg
134 Count3DeKimeteAgeru/004.jpg
135 Count3DeKimeteAgeru/005.jpg
136 Count3DeKimeteAgeru/006.jpg
137 Count3DeKimeteAgeru/007.jpg
138 Count3DeKimeteAgeru/008.jpg
139 Count3DeKimeteAgeru/009.jpg
140 DollGun/000.jpg
141 DollGun/001.jpg
142 DollGun/002.jpg
143 DollGun/003.jpg
144 DollGun/004.jpg
145 DollGun/005.jpg
146 DollGun/006.jpg
147 DollGun/007.jpg
148 DollGun/008.jpg
149 DollGun/009.jpg
150 Donburakokko/000.jpg
151 Donburakokko/001.jpg
152 Donburakokko/002.jpg
153 Donburakokko/003.jpg
154 Donburakokko/004.jpg
155 Donburakokko/005.jpg
156 Donburakokko/006.jpg
157 Donburakokko/007.jpg
158 Donburakokko/008.jpg
159 Donburakokko/009.jpg
160 DualJustice/000.jpg
161 DualJustice/001.jpg
162 DualJustice/002.jpg
163 DualJustice/003.jpg
164 DualJustice/004.jpg
165 DualJustice/005.jpg
166 DualJustice/006.jpg
167 DualJustice/007.jpg
168 DualJustice/008.jpg
169 DualJustice/009.jpg
170 EienNoWith/000.jpg
171 EienNoWith/001.jpg
172 EienNoWith/002.jpg
173 EienNoWith/003.jpg
174 EienNoWith/004.jpg
175 EienNoWith/005.jpg
176 EienNoWith/006.jpg
177 EienNoWith/007.jpg
178 EienNoWith/008.jpg
179 EienNoWith/009.jpg
180 EvaLady/000.jpg
181 EvaLady/001.jpg
182 EvaLady/002.jpg
183 EvaLady/003.jpg
184 EvaLady/004.jpg
185 EvaLady/005.jpg
186 EvaLady/006.jpg
187 EvaLady/007.jpg
188 EvaLady/008.jpg
189 EvaLady/009.jpg
190 EverydayOsakanaChan/000.jpg
191 EverydayOsakanaChan/001.jpg
192 EverydayOsakanaChan/002.jpg
193 EverydayOsakanaChan/003.jpg
194 EverydayOsakanaChan/004.jpg
195 EverydayOsakanaChan/005.jpg
196 EverydayOsakanaChan/006.jpg
197 EverydayOsakanaChan/007.jpg
198 EverydayOsakanaChan/008.jpg
199 EverydayOsakanaChan/009.jpg
200 GOOD_KISS_Ver2/000.jpg
201 GOOD_KISS_Ver2/001.jpg
202 GOOD_KISS_Ver2/002.jpg
203 GOOD_KISS_Ver2/003.jpg
204 GOOD_KISS_Ver2/004.jpg
205 GOOD_KISS_Ver2/005.jpg
206 GOOD_KISS_Ver2/006.jpg
207 GOOD_KISS_Ver2/007.jpg
208 GOOD_KISS_Ver2/008.jpg
209 GOOD_KISS_Ver2/009.jpg
210 GakuenNoise/000.jpg
211 GakuenNoise/001.jpg
212 GakuenNoise/002.jpg
213 GakuenNoise/003.jpg
214 GakuenNoise/004.jpg
215 GakuenNoise/005.jpg
216 GakuenNoise/006.jpg
217 GakuenNoise/007.jpg
218 GakuenNoise/008.jpg
219 GakuenNoise/009.jpg
220 GarakutayaManta/000.jpg
221 GarakutayaManta/001.jpg
222 GarakutayaManta/002.jpg
223 GarakutayaManta/003.jpg
224 GarakutayaManta/004.jpg
225 GarakutayaManta/005.jpg
226 GarakutayaManta/006.jpg
227 GarakutayaManta/007.jpg
228 GarakutayaManta/008.jpg
229 GarakutayaManta/009.jpg
230 GinNoChimera/000.jpg
231 GinNoChimera/001.jpg
232 GinNoChimera/002.jpg
233 GinNoChimera/003.jpg
234 GinNoChimera/004.jpg
235 GinNoChimera/005.jpg
236 GinNoChimera/006.jpg
237 GinNoChimera/007.jpg
238 GinNoChimera/008.jpg
239 GinNoChimera/009.jpg

End test....
